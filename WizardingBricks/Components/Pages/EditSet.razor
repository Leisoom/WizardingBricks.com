@page "/edit-set"
@page "/edit-set/{Id:int}"
@inject SetService SetService
@inject NavigationManager Navigation

@if(Id is null){
	<h1>Add A New Set</h1>
}
else{
	<h1>Edit Set: @CurrentSet.Name</h1>
}
<MudPaper class="pa-5 my-2" Outlined Width="80%">
	<MudItem Class="my-3">
			<MudInputLabel>Year</MudInputLabel>
			<MudTextField @bind-Value="CurrentSet.Year" Variant="Variant.Text"></MudTextField>
		</MudItem>
	<MudItem Class="my-3">
		<MudInputLabel>Number</MudInputLabel>
		<MudTextField @bind-Value="CurrentSet.Number_Of_Parts" Variant="Variant.Text"></MudTextField>
	</MudItem>
	<MudItem Class="my-3">
		<MudInputLabel>Name</MudInputLabel>
		<MudTextField @bind-Value="CurrentSet.Name" Variant="Variant.Text"></MudTextField>
	</MudItem>
		<MudItem Class="my-3">
		<MudInputLabel>Set Number</MudInputLabel>
		<MudTextField @bind-Value="CurrentSet.Set_Number" Variant="Variant.Text"></MudTextField>
	</MudItem>
	<MudItem Class="my-3">
		<MudInputLabel>Preview Image URL</MudInputLabel>
		<MudTextField @bind-Value="CurrentSet.Preview_Image_URL" Variant="Variant.Text"></MudTextField>
	</MudItem>

	<MudItem Class="my-3">
		<MudInputLabel>Instructions URL</MudInputLabel>
		<MudTextField @bind-Value="CurrentSet.Instructions_URL" Variant="Variant.Text"></MudTextField>
	</MudItem>

	<MudButton Color="Color.Primary" OnClick="SaveSet" Class="my-3">Save Set</MudButton>

</MudPaper>



@code {

	[Parameter]
	public int? Id { get; set; }
	public Set CurrentSet { get; set; } = new();

	protected override async Task OnInitializedAsync()
	{
		if (Id is not null)
		{
			var set = await SetService.GetSetById((int)Id);
			if (set is not null)
			{
				CurrentSet = set;
			}
		}
	}

	public async Task SaveSet()
	{

		if(Id is not null)
		{
			await SetService.UpdateSet(CurrentSet);
		}
		else
		{
			await SetService.AddSet(CurrentSet);
		}

		CurrentSet = new();
		Navigation.NavigateTo("/sets");
	}

}
